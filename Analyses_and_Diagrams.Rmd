---
title: "AIPD - Diagnostics and Imaging Results"
output:
  html_document:
    df_print: paged
    toc: true
    toc_depth: 2
  html_notebook: default
---

# libraries
```{r}
library(tidyverse)
library(dplyr)
library(ggplot2)
```

# preprocessing
```{r}
CATMA <- read.csv(file = "CATMA_results_final.csv", sep = ";")
head(CATMA)
```

```{r}
CATMA <- CATMA %>% rename("Tags" = 1)

# delete every second column (every article has 2 columns with the exact same content)
df <- CATMA %>% select(everything()[c(TRUE, FALSE)])
df <- df[-1]

data <- cbind(CATMA[1:2],df)
columns <- c("Tags", "Total", c(1:24))
names(data) <- columns
data
```

```{r}
year_data <- data[1:4,]
year_data
```

```{r}
synonym_data <- data[c(5:10,12:14,16:19,21:24),]
synonym_data
```

```{r}
article_type_data <- data[c(11,15,20),]
article_type_data
```

```{r}
illness_data <- data[c(25,31,35),]
illness_data
```

```{r}
sentiment_data <- data[c(34,30,26),]
sentiment_data
```

```{r}
personal_impression_data <- data[c(33,29,28),]
personal_impression_data
```

```{r}
specialization_data <- data[c(36:38,41:43),]
specialization_data

expert_data <- specialization_data[c(2,3,5,6),]
expert_data
```

```{r}
SWOT_data <- data[c(39,44,32,40),]
SWOT_data
```

# article specialization total
```{r}
specialized_unspecialized <- specialization_data[c(1,4),]

ggplot(specialized_unspecialized, aes(fill=Tags, y=Total, x=Tags)) + 
    geom_bar(position="dodge", stat="identity") +
    labs(y = "Count") +
    theme(plot.title = element_text(hjust = 0.5, size = 14),
          legend.position = "none")
```

## percentage of experts
```{r}
specialization <- tibble("Tags" = specialization_data$Tags,
                         "Article" = c(rep("specialized", 3), rep("unspecialized", 3)),
                         "Author" = c(rep(c("unknown","expert medicine", "non-expert"), 2)),
                         "Total" = c(as.integer(specialization_data$Total[1]-
                                                specialization_data$Total[2]-
                                                specialization_data$Total[3]),
                                     specialization_data$Total[2],
                                     specialization_data$Total[3],
                                     as.integer(specialization_data$Total[4]-
                                                specialization_data$Total[5]-
                                                specialization_data$Total[6]),
                                     specialization_data$Total[5],
                                     specialization_data$Total[6]))
specialization <- cbind(specialization, specialization_data[3:26])
specialization
```

```{r}
ggplot(specialization, aes(fill=Author, y=Total, x=Article)) + 
    geom_bar(position="fill", stat="identity") +
    labs(y = "Percentage", x = "Article Specialization",
         fill = "Author Expertise") +
    theme(plot.title = element_text(hjust = 0.5, size = 14)) +
    scale_fill_manual(values=c("sienna2", "rosybrown3", "ivory3"))
```

# article type total
```{r}
ggplot(article_type_data, aes(fill=Tags, y=Total, x=Tags)) + 
    geom_bar(position="dodge", stat="identity") +
    labs(y = "Count") +
    theme(plot.title = element_text(hjust = 0.5, size = 14),
          legend.position = "none") +
    scale_fill_manual(values=c("maroon","hotpink4","deeppink4"))
```

# Sentiment
# sentiment total
```{r}
ggplot(sentiment_data, aes(fill=factor(Tags,levels=c("/pro AI","/neutral","/contra AI")), y=Total, x=factor(Tags,levels=c("/pro AI","/neutral","/contra AI")))) + 
    geom_bar(position="dodge", stat="identity") +
    labs(y = "Count", x = "Tags") +
    theme(plot.title = element_text(hjust = 0.5, size = 14),
          legend.position = "none") +
    scale_fill_manual(values=c("palegreen3","seashell3","lightcoral"))
```

## article specialization and percentage of sentiment
```{r}
specialization_sentiment <- rbind(specialization_data, sentiment_data)
specialization_sentiment

specialization_sentiment <- specialization_sentiment %>%
  pivot_longer(3:26, names_to = "article", values_to = "count") %>% 
  drop_na()
specialization_sentiment

spec <- specialization_sentiment[1:40,]
sentim <- specialization_sentiment[41:95,]

specialization_sentiment <- merge.data.frame(spec[-2],sentim[-2],by="article")%>% 
                            select(c(2,4,5)) %>% 
                            group_by(Tags.x, Tags.y) %>%
                            summarise_each(list(sum = sum)) %>% 
                            rename("Article_Specialization" = 1, "Sentiment" = 2, "Count" = 3)
specialization_sentiment

expert_sentiment <- specialization_sentiment[c(4:7,11:16),]
expert_sentiment$Article_Specialization <- c(rep("expert medicine",3),"non-expert",rep("expert medicine",3),rep("non-expert", 3))
expert_sentiment <- expert_sentiment %>% 
                    group_by(Article_Specialization, Sentiment) %>%
                    summarise_each(list(sum = sum)) %>% 
                    rename("Author" = 1, "Count" = 3)
expert_sentiment
```


```{r}
ggplot(specialization_sentiment[c(1:3,8:10),], aes(fill=factor(Sentiment,levels=c("/pro AI","/neutral","/contra AI")), y=Count, x=Article_Specialization)) + 
    geom_bar(position="fill", stat="identity") +
    labs(y = "Percentage", x = "Article Specialization",
         fill = "Sentiment") +
    theme(plot.title = element_text(hjust = 0.5, size = 14)) +
    scale_fill_manual(values=c("palegreen3","seashell3","lightcoral"))
```

## author specialization and percentage of sentiment
```{r}
ggplot(expert_sentiment, aes(fill=factor(Sentiment,levels=c("/pro AI","/neutral","/contra AI")), y=Count, x=Author)) + 
    geom_bar(position="fill", stat="identity") +
    labs(y = "Percentage", x = "Author Expertise",
         fill = "Sentiment") +
    theme(plot.title = element_text(hjust = 0.5, size = 14)) +
    scale_fill_manual(values=c("palegreen3","seashell3","lightcoral"))
```

## year and percentage of sentiment
```{r}
year_sentiment <- rbind(year_data, sentiment_data)
year_sentiment

year_sentiment <- year_sentiment %>%
  pivot_longer(3:26, names_to = "article", values_to = "count") %>% 
  drop_na()
year_sentiment

sentim <- year_sentiment[25:79,]
year <- year_sentiment[1:24,]

year_sentiment <- merge.data.frame(sentim[-2],year[-2],by="article") %>% 
                            select(c(2,3,4)) %>% 
                            group_by(Tags.x, Tags.y) %>%
                            summarise_each(list(sum = sum)) %>% 
                            rename("Sentiment" = 1, "Year" = 2, "Count" = 3)
year_sentiment
```

```{r}
ggplot(year_sentiment, aes(fill=factor(Sentiment,levels=c("/pro AI","/neutral","/contra AI")), y=Count, x=Year)) + 
    geom_bar(position="fill", stat="identity") +
    labs(y = "Percentage", x = "Year",
         fill = "Sentiment") +
    theme(plot.title = element_text(hjust = 0.5, size = 14)) +
    scale_fill_manual(values=c("palegreen3","seashell3","lightcoral"))
```

## personal impression and sentiment
```{r}
impression_sentiment <- rbind(personal_impression_data, sentiment_data)
impression_sentiment

impression_sentiment <- impression_sentiment %>%
  pivot_longer(3:26, names_to = "article", values_to = "count") %>% 
  drop_na()
impression_sentiment

impr <- impression_sentiment[1:24,]
sentim <- impression_sentiment[25:79,]

impression_sentiment <- merge.data.frame(impr[-2],sentim[-2],by="article") %>% 
                            select(c(2,4,5)) %>% 
                            group_by(Tags.x, Tags.y) %>%
                            summarise_each(list(sum = sum)) %>% 
                            rename("Personal_Impression" = 1, "Sentiment" = 2, "Count" = 3)
impression_sentiment
```

```{r}
ggplot(impression_sentiment, aes(fill=factor(Personal_Impression, levels=c("/positive","/neither positive nor negative","/negative")), y=Count, x=Sentiment)) + 
    geom_bar(position="fill", stat="identity") +
    labs(y = "Percentage",
         fill = "Personal Impression") +
    theme(plot.title = element_text(hjust = 0.5, size = 14)) +
    scale_fill_manual(values=c("palegreen3","seashell3","lightcoral"))
```

# Personal Impression
# personal impression total
```{r}
ggplot(personal_impression_data, aes(fill=factor(Tags,levels=c("/positive","/neither positive nor negative","/negative")), y=Total, x=factor(Tags,levels=c("/positive","/neither positive nor negative","/negative")))) + 
    geom_bar(position="dodge", stat="identity") +
    labs(x = "Tags", y = "Count") +
    theme(plot.title = element_text(hjust = 0.5, size = 14),
          legend.position = "none") +
    scale_fill_manual(values=c("palegreen3","seashell3","lightcoral"))
```

## article specialization and percentage of personal impression
```{r}
specialization_impression <- rbind(specialization_data, personal_impression_data)
specialization_impression

specialization_impression <- specialization_impression %>%
  pivot_longer(3:26, names_to = "article", values_to = "count") %>% 
  drop_na()
specialization_impression

spec <- specialization_impression[c(1:40),]
impr <- specialization_impression[41:64,]

specialization_impression <- merge.data.frame(spec[-2],impr[-2],by="article") %>% 
                            select(c(2,4,5)) %>% 
                            group_by(Tags.x, Tags.y) %>%
                            summarise_each(list(sum = sum)) %>% 
                            rename("Article_Specialization" = 1, "Personal_Impression" = 2, "Count" = 3)
specialization_impression

expert_impression <- specialization_impression[c(3,4,8:12),]
expert_impression$Article_Specialization <- c("expert medicine","non-expert",rep("expert medicine",2),rep("non-expert",3))
expert_impression <- expert_impression %>% 
                    group_by(Article_Specialization, Personal_Impression) %>%
                    summarise_each(list(sum = sum)) %>% 
                    rename("Author" = 1, "Count" = 3)
expert_impression
```

```{r}
ggplot(specialization_impression[c(1,2,5:7),], aes(fill=factor(Personal_Impression,levels=c("/positive","/neither positive nor negative","/negative")), y=Count, x=Article_Specialization)) + 
    geom_bar(position="fill", stat="identity") +
    labs(y = "Percentage",
         x = "Article Specialization",
         fill = "Personal Impression") +
    theme(plot.title = element_text(hjust = 0.5, size = 14)) +
    scale_fill_manual(values=c("palegreen3","seashell3","lightcoral"))
```

## author specialization and percentage of personal impression

```{r}
ggplot(expert_impression, aes(fill=factor(Personal_Impression,levels=c("/positive","/neither positive nor negative","/negative")), y=Count, x=Author)) + 
    geom_bar(position="fill", stat="identity") +
    labs(y = "Percentage",
         x = "Author Expertise",
         fill = "Personal Impression") +
    theme(plot.title = element_text(hjust = 0.5, size = 14)) +
    scale_fill_manual(values=c("palegreen3","seashell3","lightcoral"))
```

## year and percentage of personal impression
```{r}
year_impression <- rbind(year_data, personal_impression_data)
year_impression

year_impression <- year_impression %>%
  pivot_longer(3:26, names_to = "article", values_to = "count") %>% 
  drop_na()
year_impression

impr <- year_impression[25:48,]
year <- year_impression[1:24,]

year_impression <- merge.data.frame(impr[-2],year[-2],by="article") %>% 
                            select(c(2,3,4)) %>% 
                            group_by(Tags.x, Tags.y) %>%
                            summarise_each(list(sum = sum)) %>% 
                            rename("Personal_Impression" = 1, "Year" = 2, "Count" = 3)
year_impression
```

```{r}
ggplot(year_impression, aes(fill=factor(Personal_Impression,levels=c("/positive","/neither positive nor negative","/negative")), y=Count, x=Year)) + 
    geom_bar(position="fill", stat="identity") +
    labs(y = "Percentage",
         fill = "Personal Impression") +
    theme(plot.title = element_text(hjust = 0.5, size = 14)) +
    scale_fill_manual(values=c("palegreen3","seashell3","lightcoral"))
```

# SWOT
# SWOT total
```{r}
ggplot(SWOT_data, aes(fill=factor(Tags, levels=c("/strength","/weakness","/opportunity","/threat")), y=Total, x=factor(Tags, levels=c("/strength","/weakness","/opportunity","/threat")))) + 
    geom_bar(position="dodge", stat="identity") +
    labs(y = "Count",
         x = "Tags") +
    theme(plot.title = element_text(hjust = 0.5, size = 14),
          legend.position = "none") +
    scale_fill_manual(values=c("deeppink3","cadetblue2","coral1","red3"))
```

## article specialization and percentage of SWOT
```{r}
specialization_SWOT <- rbind(specialization_data, SWOT_data)
specialization_SWOT

specialization_SWOT <- specialization_SWOT %>%
  pivot_longer(3:26, names_to = "article", values_to = "count") %>% 
  drop_na()
specialization_SWOT

spec <- specialization_SWOT[c(1:40),]
swot <- specialization_SWOT[41:113,]

specialization_SWOT <- merge.data.frame(spec[-2],swot[-2],by="article") %>% 
                            select(c(2,4,5)) %>% 
                            group_by(Tags.x, Tags.y) %>%
                            summarise_each(list(sum = sum)) %>% 
                            rename("Article_Specialization" = 1, "SWOT" = 2, "Count" = 3)
specialization_SWOT

expert_SWOT <- specialization_SWOT[c(5:9,14:21),]
expert_SWOT$Article_Specialization <- c(rep("expert medicine",4),"non-expert",rep("expert medicine",4),rep("non-expert",4))
expert_SWOT <- expert_SWOT %>% 
                    group_by(Article_Specialization, SWOT) %>%
                    summarise_each(list(sum = sum)) %>% 
                    rename("Author" = 1, "Count" = 3)
expert_SWOT
```

```{r}
ggplot(specialization_SWOT[c(1:4,10:13),], aes(fill=factor(SWOT, levels=c("/strength","/weakness","/opportunity","/threat")), y=Count, x=Article_Specialization)) + 
    geom_bar(position="fill", stat="identity") +
    labs(y = "Percentage",
         x = "Article Specialization",
         fill = "SWOT") +
    theme(plot.title = element_text(hjust = 0.5, size = 14)) +
    scale_fill_manual(values=c("deeppink3","cadetblue2","coral1","red3"))
```

## author specialization and percentage of SWOT

```{r}
ggplot(expert_SWOT, aes(fill=factor(SWOT, levels=c("/strength","/weakness","/opportunity","/threat")), y=Count, x=Author)) + 
    geom_bar(position="fill", stat="identity") +
    labs(y = "Percentage",
         x = "Author Expertise",
         fill = "SWOT") +
    theme(plot.title = element_text(hjust = 0.5, size = 14)) +
    scale_fill_manual(values=c("deeppink3","cadetblue2","coral1","red3"))
```

## year and percentage of SWOT
```{r}
year_SWOT <- rbind(year_data, SWOT_data)
year_SWOT

year_SWOT <- year_SWOT %>%
  pivot_longer(3:26, names_to = "article", values_to = "count") %>% 
  drop_na()
year_SWOT

swot <- year_SWOT[25:97,]
year <- year_SWOT[1:24,]

year_SWOT <- merge.data.frame(swot[-2],year[-2],by="article") %>% 
                            select(c(2,3,4)) %>% 
                            group_by(Tags.x, Tags.y) %>%
                            summarise_each(list(sum = sum)) %>% 
                            rename("SWOT" = 1, "Year" = 2, "Count" = 3)
year_SWOT
```

```{r}
ggplot(year_SWOT, aes(fill=factor(SWOT, levels=c("/strength","/weakness","/opportunity","/threat")), y=Count, x=Year)) + 
    geom_bar(position="fill", stat="identity") +
    labs(y = "Percentage",
         fill = "SWOT") +
    theme(plot.title = element_text(hjust = 0.5, size = 14))  +
    scale_fill_manual(values=c("deeppink3","cadetblue2","coral1","red3"))
```

# Synonyms
## synonyms total
```{r}
ggplot(synonym_data, aes(fill=Tags, y=Total, x=Tags)) + 
    geom_bar(position="dodge", stat="identity") +
    labs(y = "Count",
         x = "Tags") +
    theme(plot.title = element_text(hjust = 0.5, size = 14),
          axis.text.x=element_text(angle=90,hjust=1),
          legend.position = "none")
```

## article specialization and percentage of synonyms
```{r}
specialization_synonyms <- rbind(specialization_data, synonym_data)
specialization_synonyms

specialization_synonyms <- specialization_synonyms %>%
  pivot_longer(3:26, names_to = "article", values_to = "count") %>% 
  drop_na()
specialization_synonyms

spec <- specialization_synonyms[1:40,]
syn <- specialization_synonyms[41:144,]

specialization_synonyms<- merge.data.frame(spec[-2],syn[-2],by="article") %>% 
                            select(c(2,4,5)) %>% 
                            group_by(Tags.x, Tags.y) %>%
                            summarise_each(list(sum = sum)) %>% 
                            rename("Article_Specialization" = 1, "Synonyms" = 2, "Count" = 3)
specialization_synonyms

expert_synonyms <- specialization_synonyms[c(13:23,41:62),]
expert_synonyms$Article_Specialization <- c(rep("expert medicine",8),rep("non-expert",3),rep("expert medicine",5),rep("non-expert",17))
expert_synonyms <- expert_synonyms %>% 
                    group_by(Article_Specialization, Synonyms) %>%
                    summarise_each(list(sum = sum)) %>% 
                    rename("Author" = 1, "Count" = 3)
expert_synonyms
```

```{r}
ggplot(specialization_synonyms[c(1:12,24:40),], aes(fill=Synonyms, y=Count, x=Article_Specialization)) + 
    geom_bar(position="fill", stat="identity", color="black") +
    labs(title = "",
         y = "Percentage",
         x = "Article Specialization") +
    theme(plot.title = element_text(hjust = 0.5, size = 14))

#ggplot(specialization_synonyms[c(1:12,24:40),], aes(fill=Article_Specialization, y=Count, x=Synonyms)) + 
#    geom_bar(position="fill", stat="identity") +
#    labs(title = "Synonyms and Specialization of Articles",
#         x = element_blank()) +
#    theme(plot.title = element_text(hjust = 0.5, size = 14),
#          axis.text.x=element_text(angle=90,hjust=1))
```

## author specialization and percentage of synonyms

```{r}
ggplot(expert_synonyms, aes(fill=Synonyms, y=Count, x=Author)) + 
    geom_bar(position="fill", stat="identity", color = "black") +
    labs(title = "",
         y = "Percentage",
         x = "Author Expertise") +
    theme(plot.title = element_text(hjust = 0.5, size = 14))

#ggplot(expert_synonyms, aes(fill=Author, y=Count, x=Synonyms)) + 
#    geom_bar(position="fill", stat="identity") +
#    labs(title = "Synonyms and Expertise of Authors",
#         x = element_blank()) +
#    theme(plot.title = element_text(hjust = 0.5, size = 14),
#          axis.text.x=element_text(angle=90,hjust=1))
```

## year and count of synonyms
```{r}
year_synonyms <- rbind(year_data, synonym_data)
year_synonyms

year_synonyms <- year_synonyms %>%
  pivot_longer(3:26, names_to = "article", values_to = "count") %>% 
  drop_na()
year_synonyms

syn <- year_synonyms[25:128,]
year <- year_synonyms[1:24,]

year_synonyms <- merge.data.frame(syn[-2],year[-2],by="article") %>% 
                            select(c(2,3,4)) %>% 
                            group_by(Tags.x, Tags.y) %>%
                            summarise_each(list(sum = sum)) %>% 
                            rename("Synonyms" = 1, "Year" = 2, "Count" = 3)
year_synonyms
```

```{r}
#ggplot(year_synonyms, aes(fill=Synonyms, y=Count, x=Year)) + 
#    geom_bar(position="dodge", stat="identity", color = "black") +
#    labs(title = "Year and synonyms") +
#    theme(plot.title = element_text(hjust = 0.5, size = 14))

ggplot(year_synonyms, aes(fill=Year, y=Count, x=Synonyms)) + 
    geom_bar(position="dodge", stat="identity", color = "black") +
    labs(x = "Tags") +
    theme(plot.title = element_text(hjust = 0.5, size = 14),
          axis.text.x=element_text(angle=90,hjust=1))
```

## personal impression and synonyms
```{r}
impression_synonyms <- rbind(personal_impression_data, synonym_data)
impression_synonyms

impression_synonyms <- impression_synonyms %>%
  pivot_longer(3:26, names_to = "article", values_to = "count") %>% 
  drop_na()
impression_synonyms

impr <- impression_synonyms[c(1:24),]
syn <- impression_synonyms[25:128,]

impression_synonyms<- merge.data.frame(impr[-2],syn[-2],by="article") %>% 
                            select(c(2,4,5)) %>% 
                            group_by(Tags.x, Tags.y) %>%
                            summarise_each(list(sum = sum)) %>% 
                            rename("Personal_Impression" = 1, "Synonyms" = 2, "Count" = 3)
impression_synonyms
```

```{r}
ggplot(impression_synonyms, aes(fill=Synonyms, y=Count, x=factor(Personal_Impression,levels=c("/positive","/neither positive nor negative","/negative")))) + 
    geom_bar(position="fill", stat="identity", color = "black") +
    labs(title = "",
         y = "Percentage",
         x = "Personal Impression") +
    theme(plot.title = element_text(hjust = 0.5, size = 14))

ggplot(impression_synonyms, aes(fill=factor(Personal_Impression,levels=c("/positive","/neither positive nor negative","/negative")), y=Count, x=Synonyms)) + 
    geom_bar(position="fill", stat="identity") +
    labs(fill = "Personal Impression",
         y = "Percentage") +
    theme(plot.title = element_text(hjust = 0.5, size = 14),
          axis.text.x=element_text(angle=90,hjust=1)) +
    scale_fill_manual(values=c("palegreen3","seashell3","lightcoral"))
```

# Illnesses
## illnesses total
```{r}
ggplot(illness_data, aes(fill=Tags, y=Total, x=Tags)) + 
    geom_bar(position="dodge", stat="identity") +
    labs(y = "Count", x = "Tags") +
    theme(plot.title = element_text(hjust = 0.5, size = 14),
          legend.position = "none") +
    scale_fill_manual(values=c("firebrick3","aquamarine4","mediumorchid4"))
```

## year and percentage of illnesses
```{r}
year_illness <- rbind(year_data, illness_data)
year_illness

year_illness <- year_illness %>%
  pivot_longer(3:26, names_to = "article", values_to = "count") %>% 
  drop_na()
year_illness

illn <- year_illness[25:60,]
year <- year_illness[1:24,]

year_illness <- merge.data.frame(illn[-2],year[-2],by="article") %>% 
                            select(c(2,3,4)) %>% 
                            group_by(Tags.x, Tags.y) %>%
                            summarise_each(list(sum = sum)) %>% 
                            rename("Illness" = 1, "Year" = 2, "Count" = 3)
year_illness
```

```{r}
ggplot(year_illness, aes(fill=Illness, y=Count, x=Year)) + 
    geom_bar(position="fill", stat="identity") +
    labs(y = "Percentage") +
    theme(plot.title = element_text(hjust = 0.5, size = 14)) +
    scale_fill_manual(values=c("firebrick3","aquamarine4","mediumorchid4"))
```

## sentiment and illnesses
```{r}
illness_sentiment <- rbind(illness_data, sentiment_data)
illness_sentiment

illness_sentiment <- illness_sentiment %>%
  pivot_longer(3:26, names_to = "article", values_to = "count") %>% 
  drop_na()
illness_sentiment

illn <- illness_sentiment[1:36,]
sentim <- illness_sentiment[37:91,]

illness_sentiment <- merge.data.frame(illn[-2],sentim[-2],by="article") %>% 
                            select(c(2,4,5)) %>% 
                            group_by(Tags.x, Tags.y) %>%
                            summarise_each(list(sum = sum)) %>% 
                            rename("Illness" = 1, "Sentiment" = 2, "Count" = 3)
illness_sentiment
```

```{r}
ggplot(illness_sentiment, aes(fill=factor(Sentiment,levels=c("/pro AI","/neutral","/contra AI")), y=Count, x=Illness)) + 
    geom_bar(position="fill", stat="identity") +
    labs(y = "Percentage",
         fill = "Sentiment") +
    theme(plot.title = element_text(hjust = 0.5, size = 14)) +
    scale_fill_manual(values=c("palegreen3","seashell3","lightcoral"))
```

## personal impression and illnesses
```{r}
illness_impression <- rbind(illness_data, personal_impression_data)
illness_impression

illness_impression <- illness_impression %>%
  pivot_longer(3:26, names_to = "article", values_to = "count") %>% 
  drop_na()
illness_impression

illn <- illness_impression[1:36,]
impr <- illness_impression[37:60,]

illness_impression <- merge.data.frame(illn[-2],impr[-2],by="article") %>% 
                            select(c(2,3,4)) %>% 
                            group_by(Tags.x, Tags.y) %>%
                            summarise_each(list(sum = sum)) %>% 
                            rename("Illness" = 1, "Impression" = 2, "Count" = 3)
illness_impression
```

```{r}
ggplot(illness_impression, aes(fill=factor(Impression,levels=c("/positive","/neither positive nor negative","/negative")), y=Count, x=Illness)) + 
    geom_bar(position="fill", stat="identity") +
    labs(y = "Percentage",
         fill = "Personal Impression") +
    theme(plot.title = element_text(hjust = 0.5, size = 14)) +
    scale_fill_manual(values=c("palegreen3","seashell3","lightcoral"))
```

## SWOT and illnesses
```{r}
illness_SWOT <- rbind(illness_data, SWOT_data)
illness_SWOT

illness_SWOT <- illness_SWOT %>%
  pivot_longer(3:26, names_to = "article", values_to = "count") %>% 
  drop_na()
illness_SWOT

illn <- illness_SWOT[1:36,]
swot <- illness_SWOT[37:109,]

illness_SWOT <- merge.data.frame(illn[-2],swot[-2],by="article") %>% 
                            select(c(2,4,5)) %>% 
                            group_by(Tags.x, Tags.y) %>%
                            summarise_each(list(sum = sum)) %>% 
                            rename("Illness" = 1, "SWOT" = 2, "Count" = 3)
illness_SWOT
```

```{r}
ggplot(illness_SWOT, aes(fill=factor(SWOT, levels=c("/strength","/weakness","/opportunity","/threat")), y=Count, x=Illness)) + 
    geom_bar(position="fill", stat="identity") +
    labs(y = "Percentage",
         fill = "SWOT") +
    theme(plot.title = element_text(hjust = 0.5, size = 14)) +
    scale_fill_manual(values=c("deeppink3","cadetblue2","coral1","red3"))
```

# demands of action
```{r}
CATMA_demands <- read.csv(file = "CATMA_results_final_demands.csv", sep = ";", fileEncoding="UTF-8")
head(CATMA_demands)

df <- CATMA_demands %>% select(everything()[c(TRUE, FALSE)])
df <- df[-1]

demands <- cbind(CATMA_demands[1],df)
columns <- c("Annotation", c(1:17))
names(demands) <- columns
demands
```
```{r}
c(CATMA_demands["Group"])
```


